# Императивный подход

```bash
kubectl create deployment first-deployment  --image=alex501020/lesson1:v0.3
```

```bash
kubectl apply -f deployment.yaml

kubectl get deployments

k get pod

k edit -f deployment.yaml
```

```txt
$ kubectl get deployments
NAME                     READY   UP-TO-DATE   AVAILABLE   AGE
declarative-deployment   1/1     1            1           2m34s
first-deployment         1/1     1            1           5m22s
$ kubectl get pod
NAME                                     READY   STATUS    RESTARTS       AGE
declarative-deployment-85c787c88-cqd9t   1/1     Running   0              2m4s
first-deployment-785b5cd868-6fh5n        1/1     Running   1 (5m3s ago)   5m25s
```

## Команды kubectl

Смена кластеров

Работа в нашем курсе идет с одним кластером Кубернетес, однако в реальных условиях кластеров будет несколько, для переключения между ними используйте команды:

```bash
kubectl config get-contexts                          # показать список контекстов
kubectl config current-context                       # показать текущий контекст (current-context)
kubectl config use-context my-cluster-name           # установить my-cluster-name как контекст по умолчанию
```

Создание объектов

```bash
kubectl apply -f ./my-manifest.yaml            # создать объект из файла
kubectl create deployment nginx --image=nginx  # запустить один экземпляр nginx
```

Просмотр информации

```bash
kubectl get pods -o wide                      # Вывести все поды и показать, на каких они нодах
kubectl describe pods my-pod                  # Просмотреть информацию о поде такую как время                                                                 # старта, количество и причины рестартов, QoS-класс и прочее
kubectl logs -f my-pod                        # Просмотр логов в режиме реального времени
kubectl top pods                              # Вывести информацию об утилизации ресурсов подами
```

Изменение объектов

```bash
kubectl edit pod my-pod                       # Изменение .yaml манифеста пода
```

Удаление объектов

```bash
kubectl delete pod my-pod                       # Удаление пода
```

Погружение в командную оболочку Пода (проваливаемся вовнутрь)

```bash
kubectl exec -it -n namespace-name podname sh   # На конце выбираем оболочку, если нет sh, ставим bash
```

Копируем файл в под

```bash
kubectl cp {{namespace}}/{{podname}}:path/to/directory /local/path  # Копирование файла из Пода
kubectl cp /local/path namespace/podname:path/to/directory          # Копирования файла в Под
```

Проброс портов

```bash
kubectl port-forward pods/mongo-75f59d57f4-4nd6q 28015:27017  # Проброс порта Пода
kubectl port-forward mongo-75f59d57f4-4nd6q 28015:27017       # Проброс порта Сервиса
```

```txt
$ k get pod -n lesson15
NAME                                READY   STATUS      RESTARTS   AGE
goapp-deployment-558f64b89f-7tc6j   1/1     Running     0          8m24s
goapp-deployment-558f64b89f-b7b2j   1/1     Running     0          9m3s
goapp-deployment-558f64b89f-dd24h   1/1     Running     0          9m4s
pi-9hsvf                            0/1     Completed   0          47s
$ k logs -f pi-9hsvf -n lesson15
3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632788659361533818279682303019520353018529689957736225994138912497217752834791315155748572424541506959508295331168617278558890750983817546374649393192550604009277016711390098488240128583616035637076601047101819429555961989467678374494482553797747268471040475346462080466842590694912933136770289891521047521620569660240580381501935112533824300355876402474964732639141992726042699227967823547816360093417216412199245863150302861829745557067498385054945885869269956909272107975093029553211653449872027559602364806654991198818347977535663698074265425278625518184175746728909777727938000816470600161452491921732172147723501414419735685481613611573525521334757418494684385233239073941433345477624168625189835694855620992192221842725502542568876717904946016534668049886272327917860857843838279679766814541009538837863609506800642251252051173929848960841284886269456042419652850222106611863067442786220391949450471237137869609563643719172874677646575739624138908658326459958133904780275901
```